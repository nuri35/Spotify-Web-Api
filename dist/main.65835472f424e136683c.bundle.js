(()=>{"use strict";function t(t,e,r,a,n,i,c){try{var s=t[i](c),o=s.value}catch(t){return void r(t)}s.done?e(o):Promise.resolve(o).then(a,n)}function e(e){return function(){var r=this,a=arguments;return new Promise((function(n,i){var c=e.apply(r,a);function s(e){t(c,n,i,s,o,"next",e)}function o(e){t(c,n,i,s,o,"throw",e)}s(void 0)}))}}class r{constructor(){this.clientId="8edb402234fd4ea4ae574a01af924b27",this.clientSecret="05efe3427d1f440ab75e4402ee625317"}_gettoken(){var t=this;return e((function*(){try{var e=yield fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+btoa(t.clientId+":"+t.clientSecret)},body:"grant_type=client_credentials"});return(yield e.json()).access_token}catch(t){}}))()}turalma(t){return e((function*(){try{var e=yield fetch("https://api.spotify.com/v1/browse/categories?locale=sv_TR",{method:"GET",headers:{Authorization:"Bearer "+t}});return(yield e.json()).categories.items}catch(t){}}))()}_getPlaylistByGenre(t,r){return e((function*(){var e=yield fetch("https://api.spotify.com/v1/browse/categories/".concat(r,"/playlists"),{method:"GET",headers:{Authorization:"Bearer "+t}});return(yield e.json()).playlists.items}))()}getTracks(t,r){return e((function*(){var e=yield fetch("https://api.spotify.com/v1/playlists/".concat(r,"/tracks?limit=").concat(10),{method:"GET",headers:{Authorization:"Bearer "+t}});return(yield e.json()).items}))()}getTracksinfo(t,r){return e((function*(){var e=yield fetch("https://api.spotify.com/v1/tracks/".concat(r),{method:"GET",headers:{Authorization:"Bearer "+t}});return yield e.json()}))()}}function a(){return(new r)._gettoken()}function n(t,e,r,a,n,i,c){try{var s=t[i](c),o=s.value}catch(t){return void r(t)}s.done?e(o):Promise.resolve(o).then(a,n)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(a,i){var c=t.apply(e,r);function s(t){n(c,a,i,s,o,"next",t)}function o(t){n(c,a,i,s,o,"throw",t)}s(void 0)}))}}class c{constructor(){this.playing=!0,this.hak=0,this.dg=document.querySelector(".opt"),this.opt=document.querySelector("#select_genre"),this.playlıst=document.querySelector("#select_playlist"),this.opt.addEventListener("change",this.apıcontollerforplaylist.bind(this)),this.playlıst.addEventListener("change",this.getrack.bind(this)),this.listgroup=document.querySelector(".list-group"),this.albumart=document.querySelector(".album-art"),this.player=document.querySelector(".player"),this.info=document.querySelector(".info"),this.listgroup.addEventListener("click",this.musicınfo.bind(this)),this.trackIndex=-1,this.tracks=[],this.trackart=[],this.tracktext=[]}APIController(){var t=this;return i((function*(){var e,n=yield a();(yield(e=n,(new r).turalma(e))).forEach((e=>{var r=e.id;t.createGenre(r)}))}))()}apıcontollerforplaylist(t){var e=this;return i((function*(){var n,i,c=t.target.value,s=yield a(),o=yield(n=s,i=c,(new r)._getPlaylistByGenre(n,i)),l=document.querySelectorAll(".remove");if(l)for(var u=0;u<l.length;u++)l[u].remove();o.forEach((t=>{e.createplaylist(t.name,t.id)}))}))()}getrack(t){var e=this;return i((function*(){var n=document.querySelectorAll(".rmv");if(n)for(var i=0;i<n.length;i++)n[i].remove();var c,s,o=yield a(),l=t.target.value;(yield(c=o,s=l,(new r).getTracks(c,s))).forEach((t=>{t.track.preview_url&&(e.createtrack(t.track.id,t.track.name),e.tracks.push(t.track.preview_url),e.trackart.push(t.track.album.images[1].url),e.tracktext.push(t.track.name))}))}))()}musicınfo(t){var e=this;return i((function*(){t.preventDefault();var n,i,c=yield a(),s=t.target.id,o=yield(n=c,i=s,(new r).getTracksinfo(n,i));e.createmusic(o.album.name,o.album.images[1].url,o.preview_url)}))()}createGenre(t){this.opt.innerHTML+='<option value="'.concat(t,'">').concat(t,"</option>")}createplaylist(t,e){this.playlıst.innerHTML+='<option  class="remove" value="'.concat(e,'">').concat(t,"</option>")}createtrack(t,e){this.listgroup.innerHTML+='<a href="#" class="list-group-item list-group-item-action list-group-item-light rmv" id="'.concat(t,'">').concat(e,"</a>")}createmusic(t,e,r){if(r){this.player.innerHTML=' <img src="'.concat(e,'" alt="album art" class="art">\n  <div class="info">\n      <p class="text">').concat(t,'</p>\n      \n  </div> \n  <div class="prog">\n      <div class="prog-time">\n          <p class="left"></p>\n          <p class="right"></p>\n      </div>\n      <div class="prog-bar">\n          \n          <input type="range"  class="prog-bars" min="0" max="" value="0" />\n         \n      </div>\n  </div>  \n\n\n  <ul class="buttons">\n           \n  <div class="next-prev">\n  <i class="far fa-arrow-alt-circle-left fa-2x" id="prev-track"></i>\n  </div>\n  <div class="play-pause">\n  <i class="far fa-play-circle fa-3x" id="play"></i>\n  <i class="far fa-pause-circle fa-3x" id="pause"></i>\n</div>\n<div class="next-prev">\n\n<i class="far fa-arrow-alt-circle-right fa-2x" id="next-track"></i>\n</div>\n \n</ul>\n  \n  \n  '),play.style.display="none",pause.style.display="block",track.src="".concat(r),track.play(),pause.addEventListener("click",(()=>{pause.style.display="none",play.style.display="block",track.pause()})),play.addEventListener("click",(()=>{play.style.display="none",pause.style.display="block",track.play()}));var a=document.getElementById("next-track"),n=document.getElementById("prev-track");a.addEventListener("click",this.nexsong.bind(this,[t,e,r])),n.addEventListener("click",this.prevsong.bind(this));var i=setInterval((()=>{var t=document.querySelector(".prog-bars"),e=document.querySelector(".left"),r=document.querySelector(".right");t.max=track.duration,t.value=track.currentTime,e.textContent=this.formatTime(track.currentTime),r.textContent=this.formatTime(track.duration),track.currentTime===track.duration&&(pause.style.display="none",play.style.display="block",track.pause(),clearInterval(i),e.textContent=0,t.value=0)}),500)}}nexsong(t,e,r){for(var a=document.querySelector(".art"),n=document.querySelector(".text"),i=track.src,c=0;c<this.tracks.length;c++)i===this.tracks[c]&&(this.trackIndex=c+1);this.trackIndex>this.tracks.length-1&&(this.trackIndex=0),track.src=this.tracks[this.trackIndex],a.src=this.trackart[this.trackIndex],n.textContent=this.tracktext[this.trackIndex],this.playing=!0,track.play()}prevsong(){for(var t=document.querySelector(".art"),e=document.querySelector(".text"),r=track.src,a=0;a<this.tracks.length;a++)r===this.tracks[a]&&(this.trackIndex=a-1);if(-1==this.trackIndex){var n=this.tracks.length;this.trackIndex=Number(n)-1}track.src=this.tracks[this.trackIndex],t.src=this.trackart[this.trackIndex],e.textContent=this.tracktext[this.trackIndex],this.playing=!0,track.play()}formatTime(t){var e=Math.floor(t/60),r=Math.floor(t-60*e);return r<10&&(r="0".concat(r)),"".concat(e,":").concat(r)}}(new c).APIController()})();